{"ast":null,"code":"import _objectSpread from \"/home/cash/Documents/PostOffice/Frontend-React/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport { push } from 'connected-react-router';\nexport var UPDATE_PASSWORD_FIELD = 'login/UPDATE_PASSWORD_FIELD';\nexport var UPDATE_EMAIL_FIELD = 'login/UPDATE_EMAIL_FIELD';\nexport var REQUEST_LOGIN = 'login/REQUEST_LOGIN';\nexport var LOGIN_FAILED = 'login/LOGIN_FAILED';\nexport var LOGIN_SUCCESS = 'login/LOGIN_SUCCESS';\nvar initialState = {\n  email: \"\",\n  password: \"\",\n  error: {\n    is: false,\n    msg: \"\"\n  }\n};\nexport default (function () {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case UPDATE_PASSWORD_FIELD:\n      return _objectSpread({}, state, {\n        password: action.payload.password\n      });\n\n    case UPDATE_EMAIL_FIELD:\n      return _objectSpread({}, state, {\n        email: action.payload.email\n      });\n\n    case REQUEST_LOGIN:\n      return state;\n\n    case LOGIN_FAILED:\n      return _objectSpread({}, state, {\n        error: action.payload.error\n      });\n\n    case LOGIN_SUCCESS:\n      return _objectSpread({}, state);\n\n    default:\n      return state;\n  }\n});\nexport var updatePasswordField = function updatePasswordField(password) {\n  return function (dispatch) {\n    dispatch({\n      type: UPDATE_PASSWORD_FIELD,\n      payload: {\n        password: password\n      }\n    });\n  };\n};\nexport var updateEmailField = function updateEmailField(email) {\n  return function (dispatch) {\n    dispatch({\n      type: UPDATE_EMAIL_FIELD,\n      payload: {\n        email: email\n      }\n    });\n  };\n}; // TODO : CORS Credentials = Include\n\nexport var checkLoginCredentials = function checkLoginCredentials(email, password) {\n  return function (dispatch) {\n    dispatch({\n      type: REQUEST_LOGIN\n    }); // Check email and password not null\n    // Check email regex\n\n    fetch('https://api.team9postoffice.ga/auth', {\n      method: 'post',\n      'credentials': 'include',\n      headers: {\n        'accept': 'application/json, text/plain, */*',\n        'content-type': 'application/json'\n      },\n      body: JSON.stringify({\n        email: email,\n        password: password\n      })\n    }).then(function (resp) {\n      if (resp.ok) {\n        return resp.json();\n      } else {\n        dispatch({\n          type: LOGIN_FAILED,\n          payload: {\n            error: {\n              is: true,\n              msg: \"Server Error. Please try again later.\"\n            }\n          }\n        });\n      }\n    }).then(function (respJSON) {\n      console.log(respJSON);\n\n      if (respJSON.isAuth) {\n        dispatch({\n          type: LOGIN_SUCCESS\n        });\n        dispatch(push('/'));\n      } else {\n        dispatch({\n          type: LOGIN_FAILED,\n          payload: {\n            error: {\n              is: true,\n              msg: \"Invalid Credentials.\"\n            }\n          }\n        });\n      }\n    });\n  };\n};","map":{"version":3,"sources":["/home/cash/Documents/PostOffice/Frontend-React/src/reducers/login.js"],"names":["push","UPDATE_PASSWORD_FIELD","UPDATE_EMAIL_FIELD","REQUEST_LOGIN","LOGIN_FAILED","LOGIN_SUCCESS","initialState","email","password","error","is","msg","state","action","type","payload","updatePasswordField","dispatch","updateEmailField","checkLoginCredentials","fetch","method","headers","body","JSON","stringify","then","resp","ok","json","respJSON","console","log","isAuth"],"mappings":"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","sourcesContent":["import { push } from 'connected-react-router'\r\n\r\nexport const UPDATE_PASSWORD_FIELD = 'login/UPDATE_PASSWORD_FIELD';\r\nexport const UPDATE_EMAIL_FIELD = 'login/UPDATE_EMAIL_FIELD';\r\nexport const REQUEST_LOGIN = 'login/REQUEST_LOGIN';\r\nexport const LOGIN_FAILED = 'login/LOGIN_FAILED';\r\nexport const LOGIN_SUCCESS = 'login/LOGIN_SUCCESS';\r\n\r\nconst initialState = {\r\n    email: \"\",\r\n    password: \"\",\r\n    error: { is: false, msg: \"\" },\r\n};\r\n\r\nexport default (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case UPDATE_PASSWORD_FIELD:\r\n      return {\r\n        ...state,\r\n        password: action.payload.password\r\n      };\r\n    case UPDATE_EMAIL_FIELD:\r\n      return {\r\n        ...state,\r\n        email: action.payload.email\r\n      };\r\n    case REQUEST_LOGIN:\r\n      return state;\r\n    case LOGIN_FAILED:\r\n      return {\r\n        ...state,\r\n        error: action.payload.error\r\n      };\r\n    case LOGIN_SUCCESS:\r\n      return {\r\n        ...state,\r\n      };\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport const updatePasswordField = (password) => {\r\n  return dispatch => {\r\n    dispatch({ type: UPDATE_PASSWORD_FIELD, payload: { password:password } })\r\n  }\r\n};\r\n\r\nexport const updateEmailField = (email) => {\r\n  return dispatch => {\r\n    dispatch({ type: UPDATE_EMAIL_FIELD, payload: { email:email } })\r\n  }\r\n};\r\n\r\n// TODO : CORS Credentials = Include\r\nexport const checkLoginCredentials = (email, password) => {\r\n  return dispatch => {\r\n    dispatch({ type: REQUEST_LOGIN });\r\n\r\n    // Check email and password not null\r\n    // Check email regex\r\n    fetch('https://api.team9postoffice.ga/auth', {\r\n      method: 'post',\r\n      'credentials': 'include',\r\n      headers: {\r\n        'accept': 'application/json, text/plain, */*',\r\n        'content-type': 'application/json',\r\n      },\r\n      body: JSON.stringify({email: email, password: password})\r\n    }).then((resp) => {\r\n      if (resp.ok) {\r\n        return resp.json();\r\n      } else {\r\n        dispatch({ type: LOGIN_FAILED, payload: { error: { is: true, msg: \"Server Error. Please try again later.\" } } })\r\n      }\r\n    }).then((respJSON) => {\r\n      console.log(respJSON)\r\n      if (respJSON.isAuth) {\r\n        dispatch({ type: LOGIN_SUCCESS })\r\n        dispatch(push('/'))\r\n      } else {\r\n         dispatch({ type: LOGIN_FAILED, payload: { error: { is: true, msg: \"Invalid Credentials.\" } } })\r\n      }\r\n    })\r\n  }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}